# Whips — Top-Down Math Adventure (Pygame)

> A cozy, top-down puzzle game for kids. Explore a tiny forest, unlock barriers by solving math problems, and walk through the exit to advance. Difficulty ramps up across levels; answer with **multiple choice** (mouse or number keys) or **free response** (type & Enter). Level 3 includes a **scratch pad** to scribble like paper-and-pencil.

<p align="left">
  <img alt="Python" src="https://img.shields.io/badge/Python-3.8+-3776AB?logo=python&logoColor=white">
  <img alt="Pygame" src="https://img.shields.io/badge/Pygame-2.6.0-0f8a5f">
  <img alt="Pillow" src="https://img.shields.io/badge/Pillow-10+-purple">
  <img alt="License: MIT" src="https://img.shields.io/badge/License-MIT-blue.svg">
</p>

---

## ✨ Features

* **Top-down movement** (WASD / Arrow keys), smooth collisions
* **Barriers** that unlock after solving a puzzle
* **Exit door** unlocks (turns green) when all puzzles are solved; walking through advances to the next level
* **HUD** showing Solved/Attempted/Correct/Wrong; **big colorful level-end summary**
* **Two puzzle modes**

  * Multiple choice (click or press number keys 1–9)
  * Free response (type numbers, press Enter)
* **Level-based difficulty**

  * **Level 1:** Addition/Subtraction, small numbers (0–12), no negatives
  * **Level 2:** Addition/Subtraction in the hundreds (100–999)
  * **Level 3:** Multiplication/Division, with optional **scratch pad** (toggle `P`)
* **Autogenerated pixel art** background with **lake** and **castle-style walls**; simple sprites (player/tree/barrier/exit)
* **Safe spawn**: player won’t start inside obstacles

---

## 🚀 Quick Start

```bash
# (optional) create & activate a venv
python -m venv .venv
source .venv/bin/activate        # Windows: .venv\Scripts\activate

# install deps
python -m pip install --upgrade pip
python -m pip install -r requirements.txt

# generate art assets (background + sprites)
python generate_assets.py

# run the game
python main.py
```

> Conda users: `conda install -c conda-forge pygame pillow`

---

## 🗂 Project Layout

```
whips_game/
├─ main.py
├─ generate_assets.py
├─ requirements.txt
├─ .gitignore
├─ levels/
│  ├─ level1.json
│  ├─ level2.json
│  └─ level3.json
├─ assets/
│  └─ images/
│     ├─ forest_bg.png
│     ├─ player.png
│     ├─ tree.png
│     ├─ barrier.png
│     └─ exit.png
└─ scripts/
   ├─ __init__.py
   ├─ player.py        # sprite-based top-down player (has .image/.rect)
   ├─ level.py         # loads JSON, builds sprites & puzzles
   ├─ puzzles.py       # MC & free-response arithmetic + scratch pad
   ├─ barrier.py       # barrier sprite that hosts a puzzle
   └─ obstacles.py     # Tree/Water/Exit sprites
```

---

## 🎮 Controls

| Action                   | Key / Mouse                                            |
| ------------------------ | ------------------------------------------------------ |
| Move                     | **WASD** or **Arrow keys**                             |
| Answer (multiple choice) | Click option or press **1–9**                          |
| Answer (free response)   | Type number, **Enter** to submit                       |
| Scratch pad (if enabled) | **P** toggle, **C** clear; **LMB** draw, **RMB** erase |
| Continue (level summary) | **Enter / Space** (or click)                           |

---

## 🔁 Gameplay Loop

1. Walk around the map (trees/walls/water block movement).
2. Touch a locked barrier → a puzzle pops up.
3. Solve it (wrong tries are counted). The barrier unlocks and disappears.
4. When all barriers are solved, the exit unlocks (turns green).
5. Walk into the exit → **level summary** (Attempted/Solved/Correct/Wrong/Accuracy).
6. Press Enter/Space to advance to the next level (harder problems).

---

## 🧩 Levels & JSON Schema

Each level places trees, barriers (with puzzles), optional water, and the exit.

```json
{
  "background": "forest_bg.png",

  "water": { "x": 490, "y": 220, "width": 300, "height": 180 },

  "trees": [
    { "x": 120, "y": 110 },
    { "x": 220, "y": 140 }
  ],

  "barriers": [
    {
      "x": 460,
      "y": 180,
      "puzzle": {
        "type": "arithmetic_mc",        // or "arithmetic_free"
        "ops": ["add","sub","mul","div"],
        "difficulty": "easy",           // optional if min/max provided
        "choices": 4,                   // MC only
        "min": 0,                       // numeric range (optional)
        "max": 12,
        "allow_negative": false,        // subtraction behavior
        "scratch": false                // enable scratch pad overlay
      }
    }
  ],

  "exit": { "x": 900, "y": 480, "width": 32, "height": 32, "image": "exit.png" }
}
```

**Included sample levels**

* **Level 1** — add/sub, small numbers, no negatives
* **Level 2** — add/sub in hundreds
* **Level 3** — mul/div with scratch pad

Add more levels by creating `levels/levelN.json` and appending the path to `LEVEL_FILES` in `main.py`.

---

## 📊 Scoring & Level Summary

* Live HUD shows **Solved/Attempted/Correct/Wrong**.
* After each puzzle:

  * Wrong tries increment **Wrong**
  * On solve: **Correct** and **Solved** increment
  * **Attempted** increments once per puzzle completion
* After entering the exit, a **big, colorful summary** overlays the scene:

  * **Attempted / Solved / Correct / Wrong / Accuracy%**
  * Press **Enter / Space** to continue

---

## 🎨 Assets & Generation

Run `python generate_assets.py` to create:

* `assets/images/forest_bg.png` — grass + **squiggly lake** + **castle-style walls** (baked in)
* `assets/images/player.png`, `tree.png`, `barrier.png`, `exit.png`

> Tip: add `random.seed(42)` near the top of `generate_assets.py` for deterministic art if you prefer.
> You can commit generated PNGs for instant runs, or regenerate them on each clone.

---

## 🛠 Customization

* **Difficulty**: per barrier, tune `ops`, `min`, `max`, `allow_negative`, `choices`, `scratch` in the level JSON.
* **Always show scratch pad**: set `"scratch": true` on puzzles (or flip the default in `puzzles.py`).
* **Add levels**: drop new JSONs in `levels/` and update `LEVEL_FILES` in `main.py`.
* **Visuals**: tweak `generate_assets.py` (lake shape, walls, colors, speckled grass).

---

## ❗ Troubleshooting

* **Player “auto-runs” on new level**
  Clear input on level change (inside `advance_level()` and right after level summary):

  ```python
  player.reset_move()
  pygame.event.clear()
  ```
* **`Player object has no attribute 'rect'`**
  Ensure `scripts/player.py` is the sprite-based version (has `.image` & `.rect`) and import it with:

  ```python
  from scripts.player import Player
  ```
* **Images not found**
  Run `python generate_assets.py` and check files exist in `assets/images/`.

---

## 🤝 Contributing

Issues and pull requests are welcome! Ideas: adaptive difficulty, new puzzle types (word problems, patterns), sound & music, touch support for the scratch pad, save profiles/progress.

---

## 📄 License

This project is licensed under the **MIT License**.
Add a `LICENSE` file with the MIT text (or another license of your choice).

---

## 🖼 Screenshots

> Add screenshots or a short GIF here for GitHub. For example:
>
> ```
> docs/
> ├─ screenshot-1.png
> └─ gameplay.gif
> ```
>
> Then reference them:
>
> ![Gameplay](docs/screenshot-1.png)

---

### One-liner to set up & run

```bash
python -m pip install -r requirements.txt && python generate_assets.py && python main.py
```

Have fun—and happy learning!

